<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>First Person Shooter - Waves and Bosses</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #111;
            overflow: hidden;
            font-family: Arial, sans-serif;
        }

        canvas {
            display: block;
            margin: 0 auto;
        }

        #ui {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            font-size: 1.5rem;
            text-align: center;
            z-index: 1000;
        }

        .button {
            background-color: #6c63ff;
            color: white;
            font-size: 1rem;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 20px;
        }

        .button:hover {
            background-color: #3f3d56;
        }

        #shop-ui {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #222;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            color: white;
        }

        .shop-item {
            margin: 10px 0;
            padding: 10px;
            background-color: #444;
            border-radius: 5px;
        }

        .shop-item button {
            background-color: #6c63ff;
            color: white;
            font-size: 1rem;
            padding: 5px 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .shop-item button:hover {
            background-color: #3f3d56;
        }
    </style>
</head>
<body>
    <div id="ui">
        <div id="score-ui">Score: <span id="score">0</span></div>
        <div id="wave-ui">Wave: <span id="wave">1</span></div>
        <button class="button" id="openShopButton">Open Shop</button>
    </div>

    <div id="shop-ui">
        <h2>Shop</h2>
        <div class="shop-item" data-cost="10" data-gun="laser">
            <span>Laser Gun - 10 Points</span>
            <button onclick="buyWeapon(this)">Buy</button>
        </div>
        <div class="shop-item" data-cost="20" data-gun="rocket">
            <span>Rocket Launcher - 20 Points</span>
            <button onclick="buyWeapon(this)">Buy</button>
        </div>
        <button class="button" onclick="closeShop()">Close Shop</button>
    </div>

    <canvas id="fpsCanvas"></canvas>

    <script>
        const canvas = document.getElementById('fpsCanvas');
        const ctx = canvas.getContext('2d');
        const scoreDisplay = document.getElementById('score');
        const waveDisplay = document.getElementById('wave');
        const openShopButton = document.getElementById('openShopButton');
        const shopUI = document.getElementById('shop-ui');

        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        let player = {
            x: canvas.width / 2,
            y: canvas.height - 50,
            width: 20,
            height: 20,
            color: 'blue',
            speed: 5,
            weapon: 'default'
        };

        let bullets = [];
        let enemies = [];
        let wave = 1;
        let waveCountdown = 10;
        let score = 0;
        let gameInterval;

        function drawPlayer() {
            ctx.fillStyle = player.color;
            ctx.fillRect(player.x, player.y, player.width, player.height);
        }

        function openShop() {
            shopUI.style.display = 'block';
        }

        function closeShop() {
            shopUI.style.display = 'none';
        }

        function buyWeapon(button) {
            const item = button.parentElement;
            const cost = parseInt(item.getAttribute('data-cost'));
            const gun = item.getAttribute('data-gun');

            if (score >= cost) {
                score -= cost;
                scoreDisplay.textContent = score;
                player.weapon = gun;
                alert(`Purchased ${gun.charAt(0).toUpperCase() + gun.slice(1)}!`);
            } else {
                alert('Not enough points!');
            }
        }

        function drawBullets() {
            bullets.forEach((bullet, index) => {
                bullet.y -= bullet.speed;
                ctx.fillStyle = bullet.color;
                ctx.fillRect(bullet.x, bullet.y, bullet.width, bullet.height);

                if (bullet.weapon === 'rocket' && bullet.y < canvas.height / 2) {
                    explode(bullet);
                    bullets.splice(index, 1);
                } else if (bullet.y < 0) {
                    bullets.splice(index, 1);
                }
            });
        }

        function explode(bullet) {
            ctx.beginPath();
            ctx.arc(bullet.x, bullet.y, 50, 0, 2 * Math.PI);
            ctx.fillStyle = 'orange';
            ctx.fill();
            ctx.closePath();

            enemies.forEach((enemy, index) => {
                if (
                    Math.abs(enemy.x - bullet.x) < 50 &&
                    Math.abs(enemy.y - bullet.y) < 50
                ) {
                    enemies.splice(index, 1);
                    score++;
                    scoreDisplay.textContent = score;
                }
            });
        }

        function shootWeapon() {
            let bullet;
            switch (player.weapon) {
                case 'laser':
                    bullet = {
                        x: player.x + player.width / 2 - 1.5,
                        y: player.y,
                        width: 3,
                        height: 10,
                        speed: 10,
                        color: 'red',
                        weapon: 'laser'
                    };
                    break;
                case 'rocket':
                    bullet = {
                        x: player.x + player.width / 2 - 5,
                        y: player.y,
                        width: 10,
                        height: 15,
                        speed: 5,
                        color: 'yellow',
                        weapon: 'rocket'
                    };
                    break;
                default:
                    bullet = {
                        x: player.x + player.width / 2 - 2.5,
                        y: player.y,
                        width: 5,
                        height: 10,
                        speed: 5,
                        color: 'white',
                        weapon: 'default'
                    };
            }
            bullets.push(bullet);
        }

        function drawEnemies() {
            ctx.fillStyle = 'red';
            enemies.forEach((enemy, index) => {
                enemy.y += enemy.speed;
                enemy.x += enemy.direction * enemy.speed;

                if (enemy.x <= 0 || enemy.x + enemy.width >= canvas.width) {
                    enemy.direction *= -1; // Change direction on wall collision
                }

                ctx.fillRect(enemy.x, enemy.y, enemy.width, enemy.height);

                if (enemy.y > canvas.height) {
                    enemies.splice(index, 1);
                }

                bullets.forEach((bullet, bIndex) => {
                    if (
                        bullet.x < enemy.x + enemy.width &&
                        bullet.x + bullet.width > enemy.x &&
                        bullet.y < enemy.y + enemy.height &&
                        bullet.height + bullet.y > enemy.y
                    ) {
                        enemies.splice(index, 1);
                        bullets.splice(bIndex, 1);
                        score++;
                        waveCountdown--;
                        scoreDisplay.textContent = score;
                        if (waveCountdown <= 0) {
                            startNextWave();
                        }
                    }
                });
            });
        }

        function spawnEnemies() {
            const bossWave = wave % 5 === 0;
            if (bossWave) {
                if (enemies.length === 0) {
                    enemies.push({
                        x: canvas.width / 2 - 50,
                        y: -100,
                        width: 100,
                        height: 100,
                        speed: 1,
                        direction: 0,
                        isBoss: true
                    });
                }
            } else {
                if (Math.random() < 0.02) {
                    enemies.push({
                        x: Math.random() * (canvas.width - 20),
                        y: -20,
                        width: 20,
                        height: 20,
                        speed: 2 + wave * 0.1,
                        direction: Math.random() < 0.5 ? -1 : 1,
                        isBoss: false
                    });
                }
            }
        }

        function startNextWave() {
            wave++;
            waveCountdown = 10 + wave * 5;
            waveDisplay.textContent = wave;
        }

        function gameLoop() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawPlayer();
            drawBullets();
            drawEnemies();
            spawnEnemies();
        }

        window.addEventListener('mousemove', (e) => {
            player.x = e.clientX - player.width / 2;
        });

        window.addEventListener('click', shootWeapon);

        openShopButton.addEventListener('click', openShop);

        gameInterval = setInterval(gameLoop, 16);
    </script>
</body>
</html>
